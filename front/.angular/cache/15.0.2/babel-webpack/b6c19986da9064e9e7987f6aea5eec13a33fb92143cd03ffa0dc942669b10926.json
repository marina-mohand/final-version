{"ast":null,"code":"import { LessonsService } from '../lessons.service';\nimport { FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../lessons.service\";\nimport * as i3 from \"@angular/common/http\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/button\";\nconst _c0 = [\"fileInput\"];\nfunction HomeTeacherComponent_img_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 17);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r2.imageUrl, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction HomeTeacherComponent_tr_41_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"a\", 18);\n    i0.ɵɵtext(9, \"EDIT\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"td\")(11, \"a\", 19);\n    i0.ɵɵlistener(\"click\", function HomeTeacherComponent_tr_41_Template_a_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const lesson_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onDelete(lesson_r4._id));\n    });\n    i0.ɵɵtext(12, \"DELETE\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const lesson_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(lesson_r4.lessonTitle);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(lesson_r4.lessonDescription);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(lesson_r4.lessonImage);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"edit-lesson/\", lesson_r4._id, \"\", i0.ɵɵsanitizeUrl);\n  }\n}\nconst presetFiles = [new File([], \"file 1\"), new File([], \"file 2\")];\nconst presetFile = new File([], \"file 1\");\nexport class HomeTeacherComponent {\n  //fileInput!: ElementRef;\n  //On va récupérer le modèle de données de Service\n  constructor(route, router, lessonsService, http) {\n    this.route = route;\n    this.router = router;\n    this.lessonsService = lessonsService;\n    this.http = http;\n    this.display = new FormControl(\"\", Validators.required);\n    this.file_list = [];\n    this.lessonTitle = \"\";\n    this.lessonDescription = \"\";\n    this.nom = sessionStorage.getItem(\"nom\");\n  }\n  ngOnInit() {\n    this.getLessons();\n  }\n  onFileSelect(event) {\n    const file = event.target.files[0];\n    this.form.patchValue({\n      image: file\n    });\n    const allowedMimeTypes = [\"image/png\", \"image/jpeg\", \"image/jpg\"];\n    if (file && allowedMimeTypes.includes(file.type)) {\n      const reader = new FileReader();\n      reader.onload = () => {\n        this.lessonImage = reader.result;\n      };\n      reader.readAsDataURL(file);\n    }\n  }\n  onDelete(_id) {\n    if (confirm('Are you sure to delete this record ?') == true) {\n      this.lessonsService.deleteLesson(_id).subscribe(res => {\n        console.log('Deleted successfully');\n        window.location.reload();\n      });\n    }\n  }\n  getLessons() {\n    this.lessonsService.getLessons().subscribe(res => {\n      this.lessonsService.lessons = res;\n    }, error => {\n      console.log(\"Error\");\n    });\n  }\n  saveLesson(lesson, idprof) {\n    console.log(lesson.lessonTitle);\n    this.lessonsService.saveLesson(lesson, idprof);\n    window.location.reload();\n  }\n  getidprof() {\n    return sessionStorage.getItem('_id');\n  }\n  onFileUpload() {\n    const imageBlob = this.fileInput.nativeElement.files[0];\n    const file = new FormData();\n    file.set('file', imageBlob);\n    this.http.post('http://localhost:3000/', file).subscribe(response => {\n      console.log(response);\n    });\n  }\n  handleFileInput(event) {\n    const target = event.target;\n    const file = target.files;\n    this.fileToUpload = file.item(0);\n    //Show image preview\n    let reader = new FileReader();\n    reader.onload = event => {\n      this.imageUrl = event.target.result;\n    };\n    reader.readAsDataURL(this.fileToUpload);\n  }\n  static #_ = this.ɵfac = function HomeTeacherComponent_Factory(t) {\n    return new (t || HomeTeacherComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.LessonsService), i0.ɵɵdirectiveInject(i3.HttpClient));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomeTeacherComponent,\n    selectors: [[\"app-home-lesson-teacher\"]],\n    viewQuery: function HomeTeacherComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.fileInput = _t.first);\n      }\n    },\n    features: [i0.ɵɵProvidersFeature([LessonsService])],\n    decls: 42,\n    vars: 8,\n    consts: [[1, \"my-container\"], [\"name\", \"formData\", \"id\", \"formData\", 1, \"example-form\", 3, \"ngSubmit\"], [\"lessonData\", \"ngForm\"], [1, \"example-full-width\"], [\"matInput\", \"\", \"placeholder\", \"Ins\\u00E9rer le titre de la le\\u00E7on\", \"type\", \"text\", \"name\", \"lessonTitle\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Ins\\u00E9rer la description de la le\\u00E7on\", \"type\", \"text\", \"name\", \"lessonDescription\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Ins\\u00E9rer le contenu de la le\\u00E7on\", \"name\", \"lessonContenu\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"idProf\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-raised-button\", \"\", \"type\", \"submit\", \"value\", \"Ajouter\", 1, \"colorButton\"], [\"type\", \"file\", 3, \"change\"], [\"Image\", \"\"], [\"width\", \"100%\", \"class\", \"image\", 3, \"src\", 4, \"ngIf\"], [1, \"table\", \"align-middle\", \"mb-0\", \"bg-black\"], [1, \"bg-light\"], [\"id\", \"headerStyle\"], [\"matColumnDef\", \"weight\"], [4, \"ngFor\", \"ngForOf\"], [\"width\", \"100%\", 1, \"image\", 3, \"src\"], [1, \"btn\", \"btn-success\", 3, \"href\"], [1, \"btn\", \"btn-danger\", 3, \"click\"]],\n    template: function HomeTeacherComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r7 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"app-header\")(2, \"br\");\n        i0.ɵɵelementStart(3, \"h1\");\n        i0.ɵɵtext(4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"form\", 1, 2);\n        i0.ɵɵlistener(\"ngSubmit\", function HomeTeacherComponent_Template_form_ngSubmit_5_listener() {\n          i0.ɵɵrestoreView(_r7);\n          const _r0 = i0.ɵɵreference(6);\n          ctx.saveLesson(_r0.value, ctx.getidprof());\n          return i0.ɵɵresetView(ctx.getLessons());\n        });\n        i0.ɵɵelementStart(7, \"mat-form-field\", 3)(8, \"input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function HomeTeacherComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.lessonTitle = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"mat-form-field\", 3)(10, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function HomeTeacherComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.lessonDescription = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"mat-form-field\", 3)(12, \"textarea\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function HomeTeacherComponent_Template_textarea_ngModelChange_12_listener($event) {\n          return ctx.lessonContenu = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"mat-label\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function HomeTeacherComponent_Template_mat_label_ngModelChange_13_listener($event) {\n          return ctx.idProf = $event;\n        });\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"br\");\n        i0.ɵɵelementStart(16, \"button\", 8);\n        i0.ɵɵtext(17, \"Ajouter\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"input\", 9, 10);\n        i0.ɵɵlistener(\"change\", function HomeTeacherComponent_Template_input_change_18_listener($event) {\n          return ctx.handleFileInput($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(20, HomeTeacherComponent_img_20_Template, 1, 1, \"img\", 11);\n        i0.ɵɵelement(21, \"br\")(22, \"br\")(23, \"br\");\n        i0.ɵɵelementStart(24, \"h1\");\n        i0.ɵɵtext(25, \"Mes le\\u00E7ons cr\\u00E9es : \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"table\", 12)(27, \"thead\", 13)(28, \"tr\", 14)(29, \"th\");\n        i0.ɵɵtext(30, \"Title\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"th\");\n        i0.ɵɵtext(32, \"Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"th\");\n        i0.ɵɵtext(34, \"Miniature\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"th\");\n        i0.ɵɵtext(36, \"Edit\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"th\");\n        i0.ɵɵtext(38, \"Delete\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(39, \"tbody\");\n        i0.ɵɵelementContainerStart(40, 15);\n        i0.ɵɵtemplate(41, HomeTeacherComponent_tr_41_Template, 13, 4, \"tr\", 16);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"Bonjour \", ctx.nom, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.lessonTitle);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.lessonDescription);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.lessonContenu);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.idProf);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" Votre identifiant : \", ctx.getidprof(), \" \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.imageUrl);\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"ngForOf\", ctx.lessonsService.lessons);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.NgModel, i5.NgForm, i6.MatFormField, i6.MatLabel, i7.MatInput, i8.MatButton],\n    styles: [\".example-form[_ngcontent-%COMP%] {\\n  min-width: 150px;\\n  max-width: 600px;\\n  width: 100%;\\n  margin: auto;\\n  font-size: large;\\n  background-color: white;\\n  border-radius: 10px;\\n}\\n\\n.example-full-width[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\n.my-container[_ngcontent-%COMP%] {\\n  background-color: #ecd9dd;\\n  border-radius: 8px;\\n}\\n\\n.table[_ngcontent-%COMP%] {\\n  width: 80%;\\n  margin-left: auto;\\n  margin-right: auto;\\n  padding-bottom: 30px;\\n  padding-top: 30px;\\n}\\n/*# sourceURL=webpack://./src/app/home-teacher/home-teacher.component.scss */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvaG9tZS10ZWFjaGVyL2hvbWUtdGVhY2hlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0VBQ0EsZ0JBQUE7RUFFQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGdCQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtBQUFKOztBQUlFO0VBQ0UsV0FBQTtBQURKOztBQUlFO0VBQ0UseUJBQUE7RUFDQSxrQkFBQTtBQURKOztBQUlDO0VBQ0MsVUFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxvQkFBQTtFQUNBLGlCQUFBO0FBREYiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhhbXBsZS1mb3JtIHtcbiAgbWluLXdpZHRoOiAxNTBweDtcbiAgbWF4LXdpZHRoOiA2MDBweDtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbjogYXV0bztcbiAgZm9udC1zaXplOiBsYXJnZTtcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG59XG5cbi5leGFtcGxlLWZ1bGwtd2lkdGgge1xuICB3aWR0aDogMTAwJTtcbn1cblxuLm15LWNvbnRhaW5lciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNlY2Q5ZGQ7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbn1cblxuLnRhYmxlIHtcbiAgd2lkdGg6IDgwJTtcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gIG1hcmdpbi1yaWdodDogYXV0bztcbiAgcGFkZGluZy1ib3R0b206IDMwcHg7XG4gIHBhZGRpbmctdG9wOiAzMHB4O1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["LessonsService","FormControl","Validators","i0","presetFiles","File","presetFile","HomeTeacherComponent","constructor","route","router","lessonsService","http","required","sessionStorage","getItem","ngOnInit","getLessons","onFileSelect","event","file","target","files","form","patchValue","image","allowedMimeTypes","includes","type","reader","FileReader","onload","lessonImage","result","readAsDataURL","onDelete","_id","confirm","deleteLesson","subscribe","res","console","log","window","location","reload","lessons","error","saveLesson","lesson","idprof","lessonTitle","getidprof","onFileUpload","imageBlob","fileInput","nativeElement","FormData","set","post","response","handleFileInput","fileToUpload","item","imageUrl","selectors","viewQuery","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/mohand/Documents/final-version3/front/src/app/home-teacher/home-teacher.component.ts","/Users/mohand/Documents/final-version3/front/src/app/home-teacher/home-teacher.component.html"],"sourcesContent":["import { Component, Output, OnInit, Input, ElementRef, ViewChild } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { TeacherLesson } from '../models/teacher-lesson';\nimport { LessonsService } from '../lessons.service';\nimport { FormControl, FormGroup,NgForm,ReactiveFormsModule, Validators } from '@angular/forms';\nimport { User } from '../models/User';\nimport { HttpClient } from '@angular/common/http';\n\n\ndeclare var M: any;\nconst presetFiles = [new File([], \"file 1\"), new File([], \"file 2\")];\nconst presetFile = new File([], \"file 1\");\n\n@Component({\n  selector: 'app-home-lesson-teacher',\n  templateUrl: './home-teacher.component.html',\n  styleUrls: ['./home-teacher.component.scss'],\n  providers:[LessonsService],\n})\n\nexport class HomeTeacherComponent implements OnInit {\n  @ViewChild('fileInput',{static:false}) fileInput!:ElementRef;\n\n  display: FormControl = new FormControl(\"\", Validators.required);\n  file_store!: FileList ;\n  file_list: Array<string> = [];\n\n  id:any;\n  lesson!:TeacherLesson;\n  lessonTitle=\"\";\n  lessonDescription=\"\";\n  idProf!:string; \n  lessonContenu!:string;\n  lessonImage!:string;\n  form!: FormGroup;\n \n \n  \n\n  //Tableau de leçons\n  lessons : any;\n  //fileInput!: ElementRef;\n\n\n\n  //On va récupérer le modèle de données de Service\n  constructor( private route:ActivatedRoute, private router:Router, public lessonsService:LessonsService,private http : HttpClient) {\n\n \n  \n  }\n\n \n  ngOnInit(): void {\n    this.getLessons();\n\n    }\n\n    onFileSelect(event: Event) {\n      const file = (event.target as HTMLInputElement).files![0];\n      this.form.patchValue({ image: file });\n      const allowedMimeTypes = [\"image/png\", \"image/jpeg\", \"image/jpg\"];\n      if (file && allowedMimeTypes.includes(file.type)) {\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.lessonImage = reader.result as string;\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n\n    \n  \n  onDelete(_id: string) { \n    if (confirm('Are you sure to delete this record ?') == true) {\n      this.lessonsService.deleteLesson(_id).subscribe((res) => {\n        console.log('Deleted successfully');\n        window. location. reload();\n      });\n    }\n  }\n  getLessons() {\n    this.lessonsService.getLessons().subscribe(\n      (res)=>{\n        this.lessonsService.lessons = res as TeacherLesson[];\n      },\n      (error)=>{\n        console.log(\"Error\")\n      }\n    )\n  }\n  saveLesson(lesson:TeacherLesson, idprof:string){\n    console.log(lesson.lessonTitle)\n    this.lessonsService.saveLesson(lesson, idprof);\n    window.location.reload();\n  }\n  getidprof(){\n    return sessionStorage.getItem('_id') as string;\n  }\n\n  onFileUpload(){\n    const imageBlob = this.fileInput.nativeElement.files[0];\n    const file = new FormData();\n    file.set('file',imageBlob);\n    this.http.post('http://localhost:3000/',file).subscribe(response=>{\n      console.log(response);\n    })\n\n\n  }\n   \n\n\n\n  nom=sessionStorage.getItem(\"nom\")\n  fileToUpload: any;\n  imageUrl: any;\n  handleFileInput(event: Event) {\n    const target = event.target as HTMLInputElement;\n    const file = target.files!;\n    this.fileToUpload = file.item(0);\n\n    //Show image preview\n    let reader = new FileReader();\n    reader.onload = (event: any) => {\n      this.imageUrl = event.target.result;\n    }\n    reader.readAsDataURL(this.fileToUpload);\n  }\n\n  \n \n\n \n\n\n\n    \n\n     \n\n}\n","\n<div class=\"my-container\">\n\n<app-header></app-header>\n<br>\n\n<h1>Bonjour {{nom}}</h1>\n\n    <!--<form id=\"formData\"  class=\"example-form\" #lessonData=\"ngForm\" (ngSubmit)=\"saveLesson(lessonData.value);getLessons();this.form.reset();this.imageLesson='';onFileUpload();\">-->\n    <form  name=\"formData\" id=\"formData\"  class=\"example-form\" #lessonData=\"ngForm\" (ngSubmit)=\"saveLesson(lessonData.value, getidprof());getLessons();\">\n     \n                <mat-form-field class=\"example-full-width\">\n                    <input matInput placeholder=\"Insérer le titre de la leçon\" type=\"text\" [(ngModel)]=\"lessonTitle\" name=\"lessonTitle\" >\n                </mat-form-field>\n       \n           \n                <mat-form-field class=\"example-full-width\">\n                    <input matInput placeholder=\"Insérer la description de la leçon\" type=\"text\" [(ngModel)]=\"lessonDescription\"  name=\"lessonDescription\">\n                </mat-form-field>\n           \n                <mat-form-field class=\"example-full-width\">\n                    <textarea matInput placeholder=\"Insérer le contenu de la leçon\"  [(ngModel)]=\"lessonContenu\" name=\"lessonContenu\"></textarea>\n                </mat-form-field>\n                \n\n            \n                \n\n\n              <!--  <div>\n                  <input (change)=\"onFileSelect($event)\" type=\"file\" />\n                </div>\n                \n                 <div *ngIf=\"lessonImage\">\n                  <img [src]=\"lessonImage\" [alt]=\"form.value.name\"/>\n                </div>\n\n            -->\n\n       \n\n                <mat-label [(ngModel)]=\"idProf\" name=\"idProf\" > Votre identifiant : {{getidprof()}} </mat-label>\n\n           \n          \n            <br>\n     <button mat-raised-button type=\"submit\" value =\"Ajouter\" class=\"colorButton\">Ajouter</button> \n    </form>\n\n    <input #Image type=\"file\" (change)=\"handleFileInput($event)\"/>\n<img width=\"100%\" *ngIf=\"imageUrl\" [src]=\"imageUrl\" class=\"image\">\n\n<br>\n\n    <br><br>\n<h1>Mes leçons crées : </h1>\n<table class=\"table align-middle mb-0 bg-black\">\n    <thead class=\"bg-light\">\n      <tr id=\"headerStyle\">\n      \n        <th>Title</th>\n        <th>Description</th>\n        <th>Miniature</th>\n        <th>Edit</th>\n        <th>Delete</th>\n    \n      </tr>\n    </thead>\n    <tbody>\n        <ng-container matColumnDef=\"weight\">\n        <tr *ngFor=\"let lesson of lessonsService.lessons\">\n            <td>{{lesson.lessonTitle}}</td>\n            <td>{{lesson.lessonDescription}}</td>\n            <td>{{lesson.lessonImage}}</td>\n            <td>\n                <a href=\"edit-lesson/{{lesson._id}}\" class=\"btn btn-success\">EDIT</a>\n            </td>\n            <td>\n                <a class=\"btn btn-danger\" (click)=\"onDelete(lesson._id)\">DELETE</a>\n            </td>\n        </tr>\n        </ng-container>\n    \n    </tbody>\n  </table>\n\n \n\n</div>\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}